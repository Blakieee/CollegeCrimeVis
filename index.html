<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>College Crime Scrollytelling</title>
    <style>
        /* 全局样式 */
        body, html {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            font-size: 20px;
            line-height: 1.6;
            background-color: #f5f5f5;
            overflow-x: hidden;
        }

        /* Scroll Snap container */
        main {
            scroll-snap-type: y mandatory;
            overflow-y: scroll;
            height: 100vh;
        }

        /* Section styles */
        section {
            scroll-snap-align: start;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 100vh;
            padding: 20px;
            box-sizing: border-box;
        }

        /* 左侧文字 */
        .text {
            flex: 1;
            max-width: 45%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding-right: 20px;
        }

        /* 右侧图片 */
        .image {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            height: 100%;
            overflow-y: auto;
        }

        .image img {
            width: 100%;
            max-width: 800px;
            height: auto;
        }

        /* Alternating background colors */
        section:nth-child(odd) {
            background-color: #2E2E2E;
            color: #ffffff;
        }

        section:nth-child(even) {
            background-color: #4B0000;
            color: #e0e0e0;
        }

        /* Tableau chart container */
        .chart-container {
            width: 100%;
            height: 100%;
            position: relative;
        }

        .tableauPlaceholder {
            width: 100%;
            height: 100%;
        }

        .tableauViz {
            width: 100%;
            height: 100%;
            position: absolute;
        }
    </style>
</head>
<body>
    <main>
        <!-- 视频页面 -->
        <section style="display: flex; justify-content: center; align-items: center; height: 100vh; background-color: black;">
            <video id="dynamicVideo" muted loop style="width: 100%; height: 100%; object-fit: cover;" controlslist="nodownload noplaybackrate nofullscreen" disablepictureinpicture>
                <source src="videos/movie.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        </section>

        <!-- 第一页 -->
        <section>
            <div class="text">
                <h2>Crime Rate Distribution by University Type</h2>
                <p>
                    Based on the data in the chart, the <strong>interquartile range (IQR) of crime rates at private universities (0.41%)</strong> is wider compared to that of public universities (0.28%). This indicates that crime rates vary more significantly among private universities, whereas the distribution of crime rates in public universities is more concentrated.
                </p>
                <p>
                    Additionally, the <strong>median crime rate for private universities (0.33%)</strong> is higher than that of public universities (0.22%). Private universities also exhibit some extreme values where <strong>crime rates exceed 1.2%</strong>, while public universities have fewer and less severe outliers.
                </p>
            </div>
            <div class="image">
                <img src="./images/control.png" alt="Crime Rate Distribution">
            </div>
        </section>

        <!-- 第二页 -->
        <section>
            <div class="text">
                <h2>QS 2021 Rankings and Crime Rates</h2>
                <p>
                    This chart displays the <strong>QS 2021 rankings</strong> of the top 150 universities in the United States and their corresponding crime rate distributions. The grey dots represent the universities’ rankings, decreasing from left to right. The colored lines indicate each university’s crime rate, calculated by dividing the <strong>number of crimes by the number of students and expressed as a percentage</strong>. The variation in color further reflects the level of crime rates: <strong>green signifies lower crime rates</strong>, while <strong>red denotes higher crime rates</strong>.
                </p>
            </div>
            <div class="image">
                <img src="./images/rank.png" alt="QS 2021 Rankings and Crime Rates">
            </div>
        </section>

        <!-- Tableau Chart -->
        <section>
            <div class="chart-container">
                <div class='tableauPlaceholder' id='viz1733031206875'>
                    <noscript>
                        <a href='#'>
                            <img alt='Dashboard 1 ' 
                                 src='https://public.tableau.com/static/images/Bo/Book1_17326628217500/Dashboard1/1_rss.png' 
                                 style='border: none;' />
                        </a>
                    </noscript>
                    <object class='tableauViz'>
                        <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' />
                        <param name='embed_code_version' value='3' />
                        <param name='site_root' value='' />
                        <param name='name' value='Book1_17326628217500/Dashboard1' />
                        <param name='tabs' value='no' />
                        <param name='toolbar' value='yes' />
                        <param name='static_image' value='https://public.tableau.com/static/images/Bo/Book1_17326628217500/Dashboard1/1.png' />
                        <param name='animate_transition' value='yes' />
                        <param name='display_static_image' value='yes' />
                        <param name='display_spinner' value='yes' />
                        <param name='display_overlay' value='yes' />
                        <param name='display_count' value='yes' />
                        <param name='language' value='zh-CN' />
                    </object>
                </div>
            </div>
        </section>
    </main>

    <script>
        // 滚动控制视频播放速度
        const video = document.getElementById('dynamicVideo');
        let isVideoActive = true;

        // 定义滚动速度，值越大滚动速度越慢（每次滚动增加的时间更少）
        const scrollSpeed = 0.08; // 每次滚动增加 0.1 秒

        window.addEventListener(
            'wheel',
            (event) => {
                if (isVideoActive) {
                    const delta = event.deltaY; // 滚动方向和距离
                    if (delta > 0) {
                        // 向下滚动，视频向前
                        video.currentTime = Math.min(video.currentTime + scrollSpeed, video.duration);
                    } else {
                        // 向上滚动，视频向后
                        video.currentTime = Math.max(video.currentTime - scrollSpeed, 0);
                    }

                    // 如果视频播放到结尾，停止控制滚动，并允许页面继续滚动
                    if (video.currentTime === video.duration) {
                        isVideoActive = false;
                    }

                    // 阻止页面默认滚动行为
                    event.preventDefault();
                }
            },
            { passive: false }
        );

        // 视频播放结束后跳转到下一页
        video.addEventListener('ended', () => {
            isVideoActive = false; // 停止滚轮对视频的控制

            // 自动跳转到下一页
            const nextSection = video.parentElement.nextElementSibling;
            if (nextSection) {
                nextSection.scrollIntoView({ behavior: 'smooth' });
            }
        });

        // Tableau 初始化脚本
        var scriptElement = document.createElement('script');
        scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';
        scriptElement.async = true;
        document.body.appendChild(scriptElement);

        scriptElement.onload = function () {
            var divElement = document.getElementById('viz1733031206875');
            var vizElement = divElement.getElementsByTagName('object')[0];

            function resizeTableau() {
                const containerWidth = divElement.offsetWidth;
                const containerHeight = window.innerHeight;
                vizElement.style.width = containerWidth + "px";
                vizElement.style.height = containerHeight + "px";
            }

            resizeTableau();
            window.addEventListener('resize', resizeTableau);
        };
    </script>
</body>
</html>